<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>selfitisolated</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: #0f0f0f;
      background-image: radial-gradient(#222 1px, transparent 1px);
      background-size: 20px 20px;
      overflow: hidden;
    }

    .menu {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(255,255,255,0.05);
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 0.9em;
      color: #aaa;
      z-index: 3000;
      user-select: none;
    }

    .workspace {
      width: 100vw;
      min-height: 100vh;
      overflow-y: auto;
      position: relative;
    }

    .canvas {
      position: relative;
      width: 100%;
      min-height: 100vh;
      padding: 100px 40px 200px 40px;
      box-sizing: border-box;
      transform-origin: top left;
      transition: transform 0.1s ease;
    }

    .tile {
      border-radius: 12px;
      border: 4px solid transparent;
      transition: transform 0.2s ease, box-shadow 0.3s ease;
      background-color: #111;
      position: relative;
      cursor: default;
      overflow: hidden;
      z-index: 1;
      will-change: transform;
    }

    .tile:hover { box-shadow: 0 0 12px rgba(255, 255, 255, 0.2); }
    .tile.dragging { transform: scale(1.05) translateY(-5px); box-shadow: 0 0 20px rgba(255, 255, 255, 0.3); }
    .tile.sound-on { border-color: #ff6b6b !important; box-shadow: 0 0 15px rgba(255, 107, 107, 0.4); }
    .tile.floating { position: absolute !important; z-index: 2001; }

    .sound-indicator {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 20px; height: 20px;
      background: rgba(255, 107, 107, 0.8);
      border-radius: 50%;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: white;
      pointer-events: none;
      z-index: 10;
    }

    .tile img, .tile video { width: 100%; height: 100%; object-fit: contain; border-radius: 8px; pointer-events: none; }

    .error-placeholder {
      display: flex; align-items: center; justify-content: center;
      width: 100%; height: 100%;
      color: #666; font-size: 14px; text-align: center;
      border-radius: 8px; background: #222;
    }

    .welcome-overlay {
      position: fixed; top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: radial-gradient(circle at center, rgba(0,20,40,0.9), rgba(0,0,0,0.95));
      display: flex; align-items: center; justify-content: center;
      z-index: 4000; backdrop-filter: blur(10px); overflow: hidden;
    }

    .welcome-container { position: relative; text-align: center; }
    .enter-text {
      font-family: 'Courier New', monospace;
      font-size: 48px; font-weight: 700; letter-spacing: 8px;
      background: linear-gradient(135deg, #c0c0c0, #ffffff, #808080, #c0c0c0);
      background-size: 200% 200%;
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: textShimmer 4s ease-in-out infinite, isolationPulse 3s ease-in-out infinite;
      text-shadow: 0 0 20px rgba(192, 192, 192, 0.3);
      cursor: pointer; transition: all 0.4s ease; position: relative; filter: contrast(1.2);
      user-select: none;
    }

    .enter-text::before {
      content: 'ACCESS ISOLATION';
      position: absolute; inset: 0;
      background: linear-gradient(90deg, transparent 45%, rgba(0, 255, 255, 0.6) 50%, transparent 55%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
      animation: isolationScan 3s ease-in-out infinite;
      pointer-events: none;
    }

    .enter-text::after {
      content: '';
      position: absolute; left: -10%; right: -10%; top: 50%; height: 1px;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.8), transparent);
      animation: dataStream 2s linear infinite;
      pointer-events: none;
    }

    .circuit-lines { position: absolute; width: 800px; height: 300px; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none; }
    .circuit-line { position: absolute; background: linear-gradient(90deg, transparent, rgba(0,255,255,0.3), transparent); height: 1px; animation: circuitFlow 6s ease-in-out infinite; }
    .circuit-line:nth-child(1) { top: 30%; left: 0; width: 100%; animation-delay: 0s; }
    .circuit-line:nth-child(2) { top: 70%; left: 0; width: 100%; animation-delay: 2s; }
    .circuit-line:nth-child(3) { left: 25%; top: 0; height: 100%; width: 1px; background: linear-gradient(180deg, transparent, rgba(0,255,255,0.2), transparent); animation-delay: 4s; }
    .circuit-line:nth-child(4) { right: 25%; top: 0; height: 100%; width: 1px; background: linear-gradient(180deg, transparent, rgba(0,255,255,0.2), transparent); animation-delay: 1s; }

    .particles { position: absolute; inset: 0; overflow: hidden; pointer-events: none; }
    .particle { position: absolute; width: 3px; height: 3px; background: rgba(0,255,255,0.7); border-radius: 50%; animation: particleFloat 12s linear infinite; box-shadow: 0 0 8px rgba(0,255,255,0.5); }

    @keyframes dissolve { 0% { opacity:1; transform: scale(1) rotate(0deg); filter: blur(0px); } 50% { opacity:0.7; transform: scale(1.2) rotate(5deg); filter: blur(2px); } 100% { opacity:0; transform: scale(2) rotate(15deg); filter: blur(10px); } }
    @keyframes particleExplode { 0% { opacity: 1; transform: translate(0,0) scale(1); } 100% { opacity:0; transform: translate(var(--random-x), var(--random-y)) scale(0); } }
    @keyframes textShimmer { 0%,100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }
    @keyframes isolationPulse { 0%,100% { transform: scale(1); opacity:0.9; } 50% { transform: scale(1.01); opacity:1; } }
    @keyframes isolationScan { 0%,100% { background-position:-200% 0; } 50% { background-position:200% 0; } }
    @keyframes dataStream { 0% { transform: translateX(-100%); opacity:0; } 50% { opacity:1; } 100% { transform: translateX(100%); opacity:0; } }
    @keyframes circuitFlow { 0% { opacity:0; transform: scaleX(0); } 30% { opacity:0.6; transform: scaleX(1); } 70% { opacity:0.6; transform: scaleX(1); } 100% { opacity:0; transform: scaleX(0); } }
    @keyframes particleFloat { 0% { transform: translateY(100vh) translateX(0px) rotate(0deg); opacity:0; } 10% { opacity:1; } 90% { opacity:1; } 100% { transform: translateY(-100px) translateX(100px) rotate(360deg); opacity:0; } }
  </style>
</head>
<body>

<div class="welcome-overlay" id="welcomeOverlay">
  <div class="particles" id="particles"></div>
  <div class="circuit-lines">
    <div class="circuit-line"></div>
    <div class="circuit-line"></div>
    <div class="circuit-line"></div>
    <div class="circuit-line"></div>
  </div>
  <div class="welcome-container">
    <div class="enter-text" id="enterText">ACCESS ISOLATION</div>
  </div>
</div>

<div class="menu">Menu</div>
<div class="workspace"><div class="canvas" id="canvas"></div></div>

<script>
const canvas = document.getElementById('canvas');
let audioUnlocked = false;

// JSON —Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º layout –∞–¥–º–∏–Ω–∫–∏
const savedLayout = [
  {"src":"https://selfitisolated.github.io/thumbs/image1.png","type":"img","left":361.969,"top":-48.2428,"width":308,"height":308},
  {"src":"https://selfitisolated.github.io/thumbs/balenciaga.mp4","type":"video","left":541.197,"top":-106.303,"width":308,"height":308},
  {"src":"https://selfitisolated.github.io/thumbs/brds.mp4","type":"video","left":65.7793,"top":298.433,"width":308,"height":308},
  {"src":"https://selfitisolated.github.io/thumbs/mkc.png","type":"img","left":240.8,"top":316.104,"width":308,"height":308},
  {"src":"https://selfitisolated.github.io/thumbs/sora11.mp4","type":"video","left":-72.2179,"top":-104.62,"width":308,"height":308}
];

// —Å–æ–∑–¥–∞—ë–º —á–∞—Å—Ç–∏—Ü—ã welcome screen
function createParticles() {
  const particlesContainer = document.getElementById('particles');
  for(let i=0;i<30;i++){
    const p = document.createElement('div');
    p.className='particle';
    p.style.left=Math.random()*100+'%';
    p.style.animationDelay=Math.random()*12+'s';
    p.style.animationDuration=(Math.random()*6+8)+'s';
    particlesContainer.appendChild(p);
  }
}
createParticles();

function enterSite(){
  const overlay=document.getElementById('welcomeOverlay');
  const particles=overlay.querySelectorAll('.particle');
  particles.forEach(p=>{
    const randomX=(Math.random()-0.5)*2000+'px';
    const randomY=(Math.random()-0.5)*2000+'px';
    p.style.setProperty('--random-x', randomX);
    p.style.setProperty('--random-y', randomY);
  });
  overlay.classList.add('exploding','dissolving');
  setTimeout(()=>overlay.remove(),1000);
  unlockAudio();
}
document.getElementById('enterText').addEventListener('click', enterSite);

async function unlockAudio(){
  if(audioUnlocked) return;
  try{
    const audioContext = new (window.AudioContext||window.webkitAudioContext)();
    const oscillator=audioContext.createOscillator();
    const gainNode=audioContext.createGain();
    oscillator.connect(gainNode); gainNode.connect(audioContext.destination);
    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
    oscillator.start(audioContext.currentTime);
    oscillator.stop(audioContext.currentTime+0.01);
    audioUnlocked=true;
    document.querySelector('.menu').innerHTML='Menu | <span style="color: #6ecf9f;">üîä Audio Enabled</span>';
  }catch(e){console.log('Could not unlock audio:',e);}
}

// —Å–æ–∑–¥–∞—ë–º –ø–ª–∏—Ç–∫–∏ –∏–∑ JSON
function buildTilesFromLayout(layout){
  canvas.innerHTML='';
  layout.forEach(item=>{
    const tile=document.createElement('div');
    tile.className='tile floating';
    tile.style.left=item.left+'px';
    tile.style.top=item.top+'px';
    tile.style.width=item.width+'px';
    tile.style.height=item.height+'px';

    let content;
    if(item.type==='img'){
      content=document.createElement('img'); content.src=item.src;
    } else if(item.type==='video'){
      content=document.createElement('video');
      content.src=item.src; content.autoplay=true; content.loop=true; content.muted=true; content.playsInline=true;
      const soundIndicator=document.createElement('div');
      soundIndicator.className='sound-indicator'; soundIndicator.innerHTML='üîä';
      tile.appendChild(soundIndicator);
      tile.addEventListener('mouseenter',()=>{
        if(!audioUnlocked) return;
        tile.classList.add('sound-on');
        soundIndicator.style.display='flex';
        content.muted=false; content.volume=0;
        let vol=0; let fadeInterval;
        fadeInterval=setInterval(()=>{
          if(vol<0.6){vol+=0.04;content.volume=Math.min(vol,0.6);}
          else clearInterval(fadeInterval);
        },25);
      });
      tile.addEventListener('mouseleave',()=>{
        let vol=content.volume; let fadeInterval;
        tile.classList.remove('sound-on'); soundIndicator.style.display='none';
        fadeInterval=setInterval(()=>{
          if(vol>0){vol-=0.08; content.volume=Math.max(vol,0);}
          else{content.muted=true; clearInterval(fadeInterval);}
        },25);
      });
    }

    tile.appendChild(content);
    canvas.appendChild(tile);
  });
}
buildTilesFromLayout(savedLayout);

// drag‚Äôn‚Äôdrop
let activeTile=null, offsetX=0, offsetY=0, isDraggingCanvas=false, dragStartX=0, dragStartY=0;
let canvasX=0, canvasY=0, canvasScale=1;

function updateCanvasTransform(){ canvas.style.transform=`translate(${canvasX}px,${canvasY}px) scale(${canvasScale})`; }
updateCanvasTransform();

function liftTile(tile,pointerClientX,pointerClientY){
  if(tile.classList.contains('floating')) return;
  const canvasRect=canvas.getBoundingClientRect();
  const tileRect=tile.getBoundingClientRect();
  const localLeft=(tileRect.left-canvasRect.left)/canvasScale;
  const localTop=(tileRect.top-canvasRect.top)/canvasScale;
  const w=tileRect.width/canvasScale;
  const h=tileRect.height/canvasScale;
  tile.style.width=w+'px'; tile.style.height=h+'px';
  tile.classList.add('floating');
  tile.style.left=localLeft+'px'; tile.style.top=localTop+'px';
  offsetX=(pointerClientX-tileRect.left)/canvasScale;
  offsetY=(pointerClientY-tileRect.top)/canvasScale;
}

document.addEventListener('mousedown',e=>{
  const tile=e.target.closest('.tile');
  if(tile){ liftTile(tile,e.clientX,e.clientY); activeTile=tile; tile.classList.add('dragging'); tile.style.zIndex=2002; e.preventDefault(); }
  else{ isDraggingCanvas=true; dragStartX=e.clientX; dragStartY=e.clientY; }
});

document.addEventListener('mousemove',e=>{
  if(activeTile){
    const canvasRect=canvas.getBoundingClientRect();
    const newX=(e.clientX-canvasRect.left)/canvasScale-offsetX;
    const newY=(e.clientY-canvasRect.top)/canvasScale-offsetY;
    activeTile.style.left=newX+'px'; activeTile.style.top=newY+'px';
  } else if(isDraggingCanvas){
    const dx=e.clientX-dragStartX; const dy=e.clientY-dragStartY;
    canvasX+=dx; canvasY+=dy;
    dragStartX=e.clientX; dragStartY=e.clientY;
    updateCanvasTransform();
  }
});

document.addEventListener('mouseup',()=>{
  if(activeTile){ activeTile.classList.remove('dragging'); activeTile.style.zIndex=2001; activeTile=null; }
  isDraggingCanvas=false;
});

document.addEventListener('wheel',e=>{
  if(e.ctrlKey) return;
  e.preventDefault();
  const rect=canvas.getBoundingClientRect();
  const mouseX=e.clientX-rect.left;
  const mouseY=e.clientY-rect.top;
  const oldScale=canvasScale;
  const scaleAmount=e.deltaY>0?0.95:1.05;
  canvasScale*=scaleAmount; canvasScale=Math.max(0.2,Math.min(canvasScale,3));
  const scaleChange=canvasScale/oldScale;
  canvasX=mouseX-(mouseX-canvasX)*scaleChange;
  canvasY=mouseY-(mouseY-canvasY)*scaleChange;
  updateCanvasTransform();
},{passive:false});
</script>

</body>
</html>
